<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.28, target-densitydpi=device-dpi">
    <script type="text/javascript">
	    
	//Check storage for dpi_zoom - THIS CAN BREAK, DO NOT CHECK
        //if (typeof (Storage) !== "undefined") { dpi_zoom_current=localStorage.dpi_zoom };
        //if (typeof dpi_zoom_current === 'undefined') { dpi_zoom_current = 1 };   
	dpi_zoom_current = 1;  
        
	var mvp = document.getElementById('view');
	var DPR = window.devicePixelRatio;
	var w = Math.round(DPR * screen.width);
        var ratio = (screen.width / 940) / dpi_zoom_current;
	var targdensdpi = (w * DPR * 0.4133 * dpi_zoom_current);
        if (w >= 940) {mvp.setAttribute('content', 'width=device-width, initial-scale='+ ratio +', target-densitydpi=device-dpi')};
	if (w < 940) {mvp.setAttribute('content', 'width=device-width, initial-scale=1.0, maximum-scale=1.0, target-densitydpi='+ targdensdpi)};
    </script>
    
    <title></title>
<link rel="stylesheet" href="Styles/w3.css">  
</head>

<body style="background-color: #5C555A; font-family: 'Times New Roman', Times, serif; font-size: 28px; color: #FFFFFF">

    <table id="MainView" border="0" border="0" align="center" style="padding:6px; height: 120px; width: 900px;">
    <tr><td>
    <div style="padding: 10px 0px 10px 6px; font-family: calibri; font-size: 28px; font-weight: lighter;">Images loading. Please wait... </div>
    <div class="w3-light-grey w3-round">
      <div id="myBar" class="w3-container w3-round w3-green" style="height:8px;width:0%"></div>
    </div> 
    </td></tr>
    </table>

    <script src="Scripts/jquery-1.11.2.js" type="text/javascript"></script>
    <script src="Scripts/jquery-ui.js" type="text/javascript"></script>   
    <script type="text/javascript">

            function getRequests() {
                var s1 = location.search.substring(1, location.search.length).split('&'),
                r = {}, s2, i;
                for (i = 0; i < s1.length; i += 1) {
                    s2 = s1[i].split('=');
                    r[decodeURIComponent(s2[0]).toLowerCase()] = decodeURIComponent(s2[1]);
                }
                return r;
            };


            //Code for preloading images into memory
            $(document).ready(function () {

                var images = new Array();
                var QueryString = getRequests();
                var Scale = QueryString["scale"];
                var Face = QueryString["face"];
                var sRes = QueryString["sres"];

                if (sRes == undefined) { sRes = "m" };

                if (sRes == "s") {
                    var sResSuffix = "320x240";
                }

                if (sRes == "m") {
                    var sResSuffix = "640x480";
                }

                //PRELOAD IMAGES

                for (var i = 1; i <= 101; i++) {

                    if (Scale == 1 && Face == 1) {
                        var fname = "Images/DVAMS/1_MS1/" + sResSuffix + "/1MSF" + ("00" + i).slice(-3) + ".jpg";
                    }

                    if (Scale == 1 && Face == 2) {
                        var fname = "Images/DVAMS/1_MS2/" + sResSuffix + "/2MSF" + ("00" + i).slice(-3) + ".jpg";
                    }

                    if (Scale == 2 && Face == 1) {
                        var fname = "Images/DVAMS/2_SH1/" + sResSuffix + "/1SHF" + ("00" + i).slice(-3) + ".jpg";
                    }

                    if (Scale == 2 && Face == 2) {
                        var fname = "Images/DVAMS/2_SH2/" + sResSuffix + "/2SHF" + ("00" + i).slice(-3) + ".jpg";
                    }
                    
                    if (Scale == 3 && Face == 1) {
                        var fname = "Images/DVAMS/3_DP1/" + sResSuffix + "/1DPF" + ("00" + i).slice(-3) + ".jpg";
                    }

                    if (Scale == 3 && Face == 2) {
                        var fname = "Images/DVAMS/3_DP2/" + sResSuffix + "/2DPF" + ("00" + i).slice(-3) + ".jpg";
                    }

                    if (Scale == 4 && Face == 1) {
                        var fname = "Images/DVAMS/4_BE1/" + sResSuffix + "/1BEF" + ("00" + i).slice(-3) + ".jpg";
                    }

                    if (Scale == 4 && Face == 2) {
                        var fname = "Images/DVAMS/4_BE2/" + sResSuffix + "/2BEF" + ("00" + i).slice(-3) + ".jpg";
                    }

                    if (Scale == 5 && Face == 1) {
                        var fname = "Images/DVAMS/5_AFC1/" + sResSuffix + "/1AFCF" + ("00" + i).slice(-3) + ".jpg";
                    }

                    if (Scale == 5 && Face == 2) {
                        var fname = "Images/DVAMS/5_AFC2/" + sResSuffix + "/2AFCF" + ("00" + i).slice(-3) + ".jpg";
                    }

                    if (Scale == 6 && Face == 1) {
                        var fname = "Images/DVAMS/6_AGP1/" + sResSuffix + "/1AGPF" + ("00" + i).slice(-3) + ".jpg";
                    }

                    if (Scale == 6 && Face == 2) {
                        var fname = "Images/DVAMS/6_AGP2/" + sResSuffix + "/2AGPF" + ("00" + i).slice(-3) + ".jpg";
                    }

                    if (Scale == 7 && Face == 1) {
                        var fname = "Images/DVAMS/7_SA1/" + sResSuffix + "/1SAF" + ("00" + i).slice(-3) + ".jpg";
                    }

                    if (Scale == 7 && Face == 2) {
                        var fname = "Images/DVAMS/7_SA2/" + sResSuffix + "/2SAF" + ("00" + i).slice(-3) + ".jpg";
                    }

                    //Add image path to array
                    images[i] = fname;

                }

                //Check all image states and update status bar
                var imgs = [];
                var cnt = 0;
                var urls = [images[1], images[2], images[3], images[4], images[5], images[6], images[7], images[8], images[9], images[10],
                images[11], images[12], images[13], images[14], images[15], images[16], images[17], images[18], images[19], images[20],
                images[21], images[22], images[23], images[24], images[25], images[26], images[27], images[28], images[29], images[30],
                images[31], images[32], images[33], images[34], images[35], images[36], images[37], images[38], images[39], images[40],
                images[41], images[42], images[43], images[44], images[45], images[46], images[47], images[48], images[49], images[50],
                images[51], images[52], images[53], images[54], images[55], images[56], images[57], images[58], images[59], images[60],
                images[61], images[62], images[63], images[64], images[65], images[66], images[67], images[68], images[69], images[70],
                images[71], images[72], images[73], images[74], images[75], images[76], images[77], images[78], images[79], images[80],
                images[81], images[82], images[83], images[84], images[85], images[86], images[87], images[88], images[89], images[90],
                images[91], images[92], images[93], images[94], images[95], images[96], images[97], images[98], images[99], images[100],
                images[101]];
                //alert(urls);

                //Now create load event handlers to track count of images loaded
                for (var i = 0; i < urls.length; i++) {
                    var img = new Image();
                    img.onload = function () {
                        var perc = cnt + '%';
                        ++cnt;
                        $("#myBar").css({
                            "width": perc
                        });

                    };
                    img.src = urls[i];
                    imgs.push(img);
                }
                //END OF PRELOAD

            });

            $(window).load(function () {
                $("#txtStatus").val("Cacheing complete.");

                var QueryString = getRequests();
                var Scale = QueryString["scale"];
                var Face = QueryString["face"];
                var sRes = QueryString["sres"];
                var LangText = QueryString["lang"];

                //Don't make language URL for default
                if (typeof LangText === 'undefined') {
                    LangURLVAR = '';
                }
                else {
                    LangURLVAR = '&lang=' + QueryString["lang"];
                };
                //alert(LangURLVAR);

                if (sRes == undefined) { sRes = "m" };

                if (Scale == '0') {
                    //window.location = "menu_dvams.aspx";
                } else {
                    window.location = "dvams.htm?scale=" + Scale + "&face=" + Face + "&sres=" + sRes + LangURLVAR;
                    //alert("Scale=" + Scale);
                }

            });

    </script>

</body>
</html>
